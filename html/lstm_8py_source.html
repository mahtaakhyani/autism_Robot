<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: C:/Users/Mahta/Documents/GitHub/autism_Robot/src/face_pkg/scripts/detections/LSTM-Human-Activity-Recognition/lstm.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_5367b14456b88addaabc2324f551a279.html">Mahta</a></li><li class="navelem"><a class="el" href="dir_ab929254801848dc5fe75440e286ed31.html">Documents</a></li><li class="navelem"><a class="el" href="dir_1125f168b8fc5cbbf4aca29c72a712a8.html">GitHub</a></li><li class="navelem"><a class="el" href="dir_9e8f9f3b749d29e55bb2bd275afb9036.html">autism_Robot</a></li><li class="navelem"><a class="el" href="dir_d008c4279f6f78c5e49f4053a42620f5.html">src</a></li><li class="navelem"><a class="el" href="dir_017a69b5fe77c5fb869640e958c496aa.html">face_pkg</a></li><li class="navelem"><a class="el" href="dir_836fdba7a3d7a98db4891b41d76c59eb.html">scripts</a></li><li class="navelem"><a class="el" href="dir_dac2b1e5df4ee8205c971ffbf1056446.html">detections</a></li><li class="navelem"><a class="el" href="dir_3c2f78ccdb7e609d2ef2620ad7b90981.html">LSTM-Human-Activity-Recognition</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">lstm.py</div></div>
</div><!--header-->
<div class="contents">
<a href="lstm_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno"><a class="line" href="namespacelstm.html">    1</a></span> </div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="keyword">import</span> matplotlib</div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf  <span class="comment"># Version 1.0.0 (some previous versions are used in past commits)</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="keyword">import</span> os</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"># Those are separate normalised input features for the neural network</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno"><a class="line" href="namespacelstm.html#af96ec8641f1e7eecd4f967be088e77a7">   12</a></span>INPUT_SIGNAL_TYPES = [</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>    <span class="stringliteral">&quot;body_acc_x_&quot;</span>,</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>    <span class="stringliteral">&quot;body_acc_y_&quot;</span>,</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>    <span class="stringliteral">&quot;body_acc_z_&quot;</span>,</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>    <span class="stringliteral">&quot;body_gyro_x_&quot;</span>,</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>    <span class="stringliteral">&quot;body_gyro_y_&quot;</span>,</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    <span class="stringliteral">&quot;body_gyro_z_&quot;</span>,</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="stringliteral">&quot;total_acc_x_&quot;</span>,</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    <span class="stringliteral">&quot;total_acc_y_&quot;</span>,</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    <span class="stringliteral">&quot;total_acc_z_&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>]</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment"># Output classes to learn how to classify</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="namespacelstm.html#a338231577930e25027432ff42b6ca2f9">   25</a></span>LABELS = [</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    <span class="stringliteral">&quot;WALKING&quot;</span>, </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    <span class="stringliteral">&quot;WALKING_UPSTAIRS&quot;</span>, </div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    <span class="stringliteral">&quot;WALKING_DOWNSTAIRS&quot;</span>, </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    <span class="stringliteral">&quot;SITTING&quot;</span>, </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    <span class="stringliteral">&quot;STANDING&quot;</span>, </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    <span class="stringliteral">&quot;LAYING&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>] </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="namespacelstm.html#af87abc8d7ee9e7a2a1aa04363e40647f">   35</a></span>TRAIN = <span class="stringliteral">&quot;train/&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno"><a class="line" href="namespacelstm.html#adc2419d0862eadc2a313b8b02f885b97">   36</a></span>TEST = <span class="stringliteral">&quot;test/&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment"># Load &quot;X&quot; (the neural network&#39;s training and testing inputs)</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="namespacelstm.html#a3bc20b3094c9acd517d4460f1902be84">   41</a></span><span class="keyword">def </span><a class="code hl_function" href="namespacelstm.html#a3bc20b3094c9acd517d4460f1902be84">load_X</a>(X_signals_paths):</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    X_signals = []</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="keywordflow">for</span> signal_type_path <span class="keywordflow">in</span> X_signals_paths:</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>        file = open(signal_type_path, <span class="stringliteral">&#39;r&#39;</span>)</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>        <span class="comment"># Read dataset from disk, dealing with text files&#39; syntax</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        X_signals.append(</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>            [np.array(serie, dtype=np.float32) <span class="keywordflow">for</span> serie <span class="keywordflow">in</span> [</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>                row.replace(<span class="stringliteral">&#39;  &#39;</span>, <span class="stringliteral">&#39; &#39;</span>).strip().split(<span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">for</span> row <span class="keywordflow">in</span> file</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>            ]]</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        )</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>        file.close()</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    <span class="keywordflow">return</span> np.transpose(np.array(X_signals), (1, 2, 0))</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="namespacelstm.html#ac4cb6bb714a0e905b73f04a79890bb70">   56</a></span>X_train_signals_paths = [</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    DATASET_PATH + TRAIN + <span class="stringliteral">&quot;Inertial Signals/&quot;</span> + signal + <span class="stringliteral">&quot;train.txt&quot;</span> <span class="keywordflow">for</span> signal <span class="keywordflow">in</span> INPUT_SIGNAL_TYPES</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>]</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="namespacelstm.html#a81e44df5d8d78bf3605ab9594ee93d05">   59</a></span>X_test_signals_paths = [</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    DATASET_PATH + TEST + <span class="stringliteral">&quot;Inertial Signals/&quot;</span> + signal + <span class="stringliteral">&quot;test.txt&quot;</span> <span class="keywordflow">for</span> signal <span class="keywordflow">in</span> INPUT_SIGNAL_TYPES</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>]</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno"><a class="line" href="namespacelstm.html#a08771c7fcddc9a9a5a228df161092041">   63</a></span>X_train = <a class="code hl_function" href="namespacelstm.html#a3bc20b3094c9acd517d4460f1902be84">load_X</a>(X_train_signals_paths)</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno"><a class="line" href="namespacelstm.html#a082485d328776a8d27761bb415c1c118">   64</a></span>X_test = <a class="code hl_function" href="namespacelstm.html#a3bc20b3094c9acd517d4460f1902be84">load_X</a>(X_test_signals_paths)</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment"># Load &quot;y&quot; (the neural network&#39;s training and testing outputs)</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno"><a class="line" href="namespacelstm.html#ac5423ba2f95f4d9c7810eb3904fac143">   69</a></span><span class="keyword">def </span><a class="code hl_function" href="namespacelstm.html#ac5423ba2f95f4d9c7810eb3904fac143">load_y</a>(y_path):</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    file = open(y_path, <span class="stringliteral">&#39;r&#39;</span>)</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <span class="comment"># Read dataset from disk, dealing with text file&#39;s syntax</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    y_ = np.array(</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        [elem <span class="keywordflow">for</span> elem <span class="keywordflow">in</span> [</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>            row.replace(<span class="stringliteral">&#39;  &#39;</span>, <span class="stringliteral">&#39; &#39;</span>).strip().split(<span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">for</span> row <span class="keywordflow">in</span> file</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        ]], </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        dtype=np.int32</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    )</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    file.close()</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="comment"># Substract 1 to each output class for friendly 0-based indexing </span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="keywordflow">return</span> y_ - 1</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno"><a class="line" href="namespacelstm.html#ab196800315574a2f4bb59f4452149cdc">   83</a></span>y_train_path = DATASET_PATH + TRAIN + <span class="stringliteral">&quot;y_train.txt&quot;</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno"><a class="line" href="namespacelstm.html#a355afcd7e7d8062505562a9e82b40ecd">   84</a></span>y_test_path = DATASET_PATH + TEST + <span class="stringliteral">&quot;y_test.txt&quot;</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno"><a class="line" href="namespacelstm.html#aee43ad9a0cb10f440a739f084b08ae70">   86</a></span>y_train = <a class="code hl_function" href="namespacelstm.html#ac5423ba2f95f4d9c7810eb3904fac143">load_y</a>(y_train_path)</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="namespacelstm.html#a7db7f9ae63d7b92fac39334808c300fe">   87</a></span>y_test = <a class="code hl_function" href="namespacelstm.html#ac5423ba2f95f4d9c7810eb3904fac143">load_y</a>(y_test_path)</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno"><a class="line" href="namespacelstm.html#a5c996f9627dfa9934adf6ce4ecbaa754">   90</a></span>training_data_count = len(X_train)  <span class="comment"># 7352 training series (with 50% overlap between each serie)</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="namespacelstm.html#a3917a3461be556ca18c6c5857491645f">   91</a></span>test_data_count = len(X_test)  <span class="comment"># 2947 testing series</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="namespacelstm.html#add540085a278e7be1bd11b9fa5fc7a42">   92</a></span>n_steps = len(X_train[0])  <span class="comment"># 128 timesteps per series</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="namespacelstm.html#a994629e010547b8aab8abac3bf7c3989">   93</a></span>n_input = len(X_train[0][0])  <span class="comment"># 9 input parameters per timestep</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="comment"># LSTM Neural Network&#39;s internal structure</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="namespacelstm.html#ae60ccc7c148c0fed9ae6c926fd968351">   98</a></span>n_hidden = 32 <span class="comment"># Hidden layer num of features</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="namespacelstm.html#ad812941a3a6951a09643fc4cb5aa26cb">   99</a></span>n_classes = 6 <span class="comment"># Total classes (should go up, or should go down)</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span><span class="comment"># Training </span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="namespacelstm.html#ae7628ce480f83e060e28e0583cb20313">  104</a></span>learning_rate = 0.0025</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="namespacelstm.html#a11043b2d6c0075bbb78008b34555f795">  105</a></span>lambda_loss_amount = 0.0015</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno"><a class="line" href="namespacelstm.html#ace72634e0fe05d0a5c01f7617387bdaa">  106</a></span>training_iters = training_data_count * 300  <span class="comment"># Loop 300 times on the dataset</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="namespacelstm.html#a0a204d2b68021277b46f34ce19d2bc03">  107</a></span>batch_size = 1500</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno"><a class="line" href="namespacelstm.html#a5f435a232d9f04ea0214724c1d31f250">  108</a></span>display_iter = 30000  <span class="comment"># To show test set accuracy during training</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="comment"># Some debugging info</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>print(<span class="stringliteral">&quot;Some useful info to get an insight on dataset&#39;s shape and normalisation:&quot;</span>)</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>print(<span class="stringliteral">&quot;(X shape, y shape, every X&#39;s mean, every X&#39;s standard deviation)&quot;</span>)</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>print(X_test.shape, y_test.shape, np.mean(X_test), np.std(X_test))</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>print(<span class="stringliteral">&quot;The dataset is therefore properly normalised, as expected, but not yet one-hot encoded.&quot;</span>)</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="namespacelstm.html#a42deb1962231fef2385848f4fbf685f9">  119</a></span><span class="keyword">def </span><a class="code hl_function" href="namespacelstm.html#a42deb1962231fef2385848f4fbf685f9">LSTM_RNN</a>(_X, _weights, _biases):</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="comment"># Function returns a tensorflow LSTM (RNN) artificial neural network from given parameters. </span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    <span class="comment"># Moreover, two LSTM cells are stacked which adds deepness to the neural network. </span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    <span class="comment"># Note, some code of this notebook is inspired from an slightly different </span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    <span class="comment"># RNN architecture used on another dataset, some of the credits goes to </span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    <span class="comment"># &quot;aymericdamien&quot; under the MIT license.</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="comment"># (NOTE: This step could be greatly optimised by shaping the dataset once</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <span class="comment"># input shape: (batch_size, n_steps, n_input)</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    _X = tf.transpose(_X, [1, 0, 2])  <span class="comment"># permute n_steps and batch_size</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    <span class="comment"># Reshape to prepare input to hidden activation</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    _X = tf.reshape(_X, [-1, n_input]) </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="comment"># new shape: (n_steps*batch_size, n_input)</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <span class="comment"># ReLU activation, thanks to Yu Zhao for adding this improvement here:</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    _X = tf.nn.relu(tf.matmul(_X, _weights[<span class="stringliteral">&#39;hidden&#39;</span>]) + _biases[<span class="stringliteral">&#39;hidden&#39;</span>])</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="comment"># Split data because rnn cell needs a list of inputs for the RNN inner loop</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    _X = tf.split(_X, n_steps, 0) </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="comment"># new shape: n_steps * (batch_size, n_hidden)</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="comment"># Define two stacked LSTM cells (two recurrent layers deep) with tensorflow</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    lstm_cell_1 = tf.contrib.rnn.BasicLSTMCell(n_hidden, forget_bias=1.0, state_is_tuple=<span class="keyword">True</span>)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    lstm_cell_2 = tf.contrib.rnn.BasicLSTMCell(n_hidden, forget_bias=1.0, state_is_tuple=<span class="keyword">True</span>)</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    lstm_cells = tf.contrib.rnn.MultiRNNCell([lstm_cell_1, lstm_cell_2], state_is_tuple=<span class="keyword">True</span>)</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <span class="comment"># Get LSTM cell output</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    outputs, states = tf.contrib.rnn.static_rnn(lstm_cells, _X, dtype=tf.float32)</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <span class="comment"># Get last time step&#39;s output feature for a &quot;many-to-one&quot; style classifier, </span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="comment"># as in the image describing RNNs at the top of this page</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    lstm_last_output = outputs[-1]</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <span class="comment"># Linear activation</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <span class="keywordflow">return</span> tf.matmul(lstm_last_output, _weights[<span class="stringliteral">&#39;out&#39;</span>]) + _biases[<span class="stringliteral">&#39;out&#39;</span>]</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno"><a class="line" href="namespacelstm.html#a1219948b6046f13ce3223eeb4e4fae9a">  154</a></span><span class="keyword">def </span><a class="code hl_function" href="namespacelstm.html#a1219948b6046f13ce3223eeb4e4fae9a">extract_batch_size</a>(_train, step, batch_size):</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <span class="comment"># Function to fetch a &quot;batch_size&quot; amount of data from &quot;(X|y)_train&quot; data. </span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    shape = list(_train.shape)</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    shape[0] = batch_size</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    batch_s = np.empty(shape)</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(batch_size):</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        <span class="comment"># Loop index</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        index = ((step-1)*batch_size + i) % len(_train)</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        batch_s[i] = _train[index] </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="keywordflow">return</span> batch_s</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="namespacelstm.html#a2d6b5b10a271e1f89560deba35d1d12d">  169</a></span><span class="keyword">def </span><a class="code hl_function" href="namespacelstm.html#a2d6b5b10a271e1f89560deba35d1d12d">one_hot</a>(y_, n_classes=n_classes):</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <span class="comment"># Function to encode neural one-hot output labels from number indexes </span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    <span class="comment"># e.g.: </span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    <span class="comment"># one_hot(y_=[[5], [0], [3]], n_classes=6):</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    <span class="comment">#     return [[0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0], [0, 0, 0, 1, 0, 0]]</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    y_ = y_.reshape(len(y_))</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <span class="keywordflow">return</span> np.eye(n_classes)[np.array(y_, dtype=np.int32)]  <span class="comment"># Returns FLOATS</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span><span class="comment"># Graph input/output</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno"><a class="line" href="namespacelstm.html#a9120b8eaa13094bffb6ea06c723952d7">  181</a></span>x = tf.placeholder(tf.float32, [<span class="keywordtype">None</span>, n_steps, n_input])</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno"><a class="line" href="namespacelstm.html#a6d589c9111d1343348235ceb16678912">  182</a></span>y = tf.placeholder(tf.float32, [<span class="keywordtype">None</span>, n_classes])</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span><span class="comment"># Graph weights</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="namespacelstm.html#a1f813fa163262ed4b185503d79ed5214">  185</a></span>weights = {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="stringliteral">&#39;hidden&#39;</span>: tf.Variable(tf.random_normal([n_input, n_hidden])), <span class="comment"># Hidden layer weights</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="stringliteral">&#39;out&#39;</span>: tf.Variable(tf.random_normal([n_hidden, n_classes], mean=1.0))</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>}</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="namespacelstm.html#abc134e3d69e6ce31d1d99e6768a2dc49">  189</a></span>biases = {</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="stringliteral">&#39;hidden&#39;</span>: tf.Variable(tf.random_normal([n_hidden])),</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <span class="stringliteral">&#39;out&#39;</span>: tf.Variable(tf.random_normal([n_classes]))</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>}</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno"><a class="line" href="namespacelstm.html#ac3266a11fd253a8ef466d46bd9723123">  194</a></span>pred = <a class="code hl_function" href="namespacelstm.html#a42deb1962231fef2385848f4fbf685f9">LSTM_RNN</a>(x, weights, biases)</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="comment"># Loss, optimizer and evaluation</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno"><a class="line" href="namespacelstm.html#ab77c6f58cdb80a03e3394456d175860c">  197</a></span>l2 = lambda_loss_amount * sum(</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    tf.nn.l2_loss(tf_var) <span class="keywordflow">for</span> tf_var <span class="keywordflow">in</span> tf.trainable_variables()</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>) <span class="comment"># L2 loss prevents this overkill neural network to overfit the data</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno"><a class="line" href="namespacelstm.html#ae77e74e654eefbfc42750ae1ed37b8c2">  200</a></span>cost = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=y, logits=pred)) + l2 <span class="comment"># Softmax loss</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno"><a class="line" href="namespacelstm.html#acbdba3cb10685a11796a8a57f8dc697f">  201</a></span>optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate).minimize(cost) <span class="comment"># Adam Optimizer</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno"><a class="line" href="namespacelstm.html#a6306f8d05448970701567c7d93bb0bef">  203</a></span>correct_pred = tf.equal(tf.argmax(pred,1), tf.argmax(y,1))</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno"><a class="line" href="namespacelstm.html#a55357ac09f041f86ce4edaf1a0592310">  204</a></span>accuracy = tf.reduce_mean(tf.cast(correct_pred, tf.float32))</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span><span class="comment"># To keep track of training&#39;s performance</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno"><a class="line" href="namespacelstm.html#ad71b4bd64ef711ad981efefb11cf06be">  207</a></span>test_losses = []</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno"><a class="line" href="namespacelstm.html#ac9c7f541f4f4bd4baffd5f38a5d11201">  208</a></span>test_accuracies = []</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno"><a class="line" href="namespacelstm.html#a027cb2ca5e4b298116a9a136c6b03335">  209</a></span>train_losses = []</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno"><a class="line" href="namespacelstm.html#abb0758c9bc09f3c5cadab391dbfdf26f">  210</a></span>train_accuracies = []</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span><span class="comment"># Launch the graph</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno"><a class="line" href="namespacelstm.html#a0ab00ed18c615e211c843b25cc4b1758">  213</a></span>sess = tf.InteractiveSession(config=tf.ConfigProto(log_device_placement=<span class="keyword">True</span>))</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno"><a class="line" href="namespacelstm.html#a78e07921bb6a25654abf6cc642f22f49">  214</a></span>init = tf.global_variables_initializer()</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>sess.run(init)</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span><span class="comment"># Perform Training steps with &quot;batch_size&quot; amount of example data at each loop</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno"><a class="line" href="namespacelstm.html#ab92d83492e2025a54277995bb009dc00">  218</a></span>step = 1</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span><span class="keywordflow">while</span> step * batch_size &lt;= training_iters:</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno"><a class="line" href="namespacelstm.html#ab914c3557273434297af6654a90c779a">  220</a></span>    batch_xs =         <a class="code hl_function" href="namespacelstm.html#a1219948b6046f13ce3223eeb4e4fae9a">extract_batch_size</a>(X_train, step, batch_size)</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno"><a class="line" href="namespacelstm.html#a99bc7e9725e05a0a2928de832459c9f2">  221</a></span>    batch_ys = <a class="code hl_function" href="namespacelstm.html#a2d6b5b10a271e1f89560deba35d1d12d">one_hot</a>(<a class="code hl_function" href="namespacelstm.html#a1219948b6046f13ce3223eeb4e4fae9a">extract_batch_size</a>(y_train, step, batch_size))</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="comment"># Fit training using batch data</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno"><a class="line" href="namespacelstm.html#aaf916d5270043aa46b022d39b9b08714">  224</a></span>    _, loss, acc = sess.run(</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>        [optimizer, cost, accuracy],</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno"><a class="line" href="namespacelstm.html#acc1b01cb24c8a0ab379651d7a9d9bb71">  226</a></span>        feed_dict={</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            x: batch_xs, </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            y: batch_ys</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>        }</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    )</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    train_losses.append(loss)</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    train_accuracies.append(acc)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="comment"># Evaluate network only at some steps for faster training: </span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <span class="keywordflow">if</span> (step*batch_size % display_iter == 0) <span class="keywordflow">or</span> (step == 1) <span class="keywordflow">or</span> (step * batch_size &gt; training_iters):</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        <span class="comment"># To not spam console, show training accuracy/loss in this &quot;if&quot;</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        print(<span class="stringliteral">&quot;Training iter #&quot;</span> + str(step*batch_size) + \</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>              <span class="stringliteral">&quot;:   Batch Loss = &quot;</span> + <span class="stringliteral">&quot;{:.6f}&quot;</span>.format(loss) + \</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>              <span class="stringliteral">&quot;, Accuracy = {}&quot;</span>.format(acc))</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>        <span class="comment"># Evaluation on the test set (no learning made here - just evaluation for diagnosis)</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        loss, acc = sess.run(</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            [cost, accuracy], </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>            feed_dict={</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>                x: X_test,</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>                y: <a class="code hl_function" href="namespacelstm.html#a2d6b5b10a271e1f89560deba35d1d12d">one_hot</a>(y_test)</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>            }</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        )</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        test_losses.append(loss)</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        test_accuracies.append(acc)</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        print(<span class="stringliteral">&quot;PERFORMANCE ON TEST SET: &quot;</span> + \</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>              <span class="stringliteral">&quot;Batch Loss = {}&quot;</span>.format(loss) + \</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>              <span class="stringliteral">&quot;, Accuracy = {}&quot;</span>.format(acc))</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    step += 1</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>print(<span class="stringliteral">&quot;Optimization Finished!&quot;</span>)</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="comment"># Accuracy for test data</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno"><a class="line" href="namespacelstm.html#a3a79a7a0b9a5cb284279f1529916ea5a">  262</a></span>one_hot_predictions, accuracy, final_loss = sess.run(</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    [pred, accuracy, cost],</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    feed_dict={</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        x: X_test,</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        y: <a class="code hl_function" href="namespacelstm.html#a2d6b5b10a271e1f89560deba35d1d12d">one_hot</a>(y_test)</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    }</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>)</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>test_losses.append(final_loss)</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>test_accuracies.append(accuracy)</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>print(<span class="stringliteral">&quot;FINAL RESULT: &quot;</span> + \</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      <span class="stringliteral">&quot;Batch Loss = {}&quot;</span>.format(final_loss) + \</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>      <span class="stringliteral">&quot;, Accuracy = {}&quot;</span>.format(accuracy))</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno"><a class="line" href="namespacelstm.html#a17e28cadcbbceafb8a9c371059a33860">  277</a></span>font = {</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="stringliteral">&#39;family&#39;</span> : <span class="stringliteral">&#39;Bitstream Vera Sans&#39;</span>,</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <span class="stringliteral">&#39;weight&#39;</span> : <span class="stringliteral">&#39;bold&#39;</span>,</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    <span class="stringliteral">&#39;size&#39;</span>   : 18</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>}</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>matplotlib.rc(<span class="stringliteral">&#39;font&#39;</span>, **font)</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno"><a class="line" href="namespacelstm.html#a91523f0634a0bb0c730016b53358e084">  284</a></span>width = 12</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno"><a class="line" href="namespacelstm.html#a94688271df8661d2fa18654da87d63ed">  285</a></span>height = 12</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno"><a class="line" href="namespacelstm.html#ac3d815889bba27f61f411c105467dc0d">  286</a></span>plt.figure(figsize=(width, height))</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno"><a class="line" href="namespacelstm.html#ad5ed42f25c969e93f43da6a48adb5951">  288</a></span>indep_train_axis = np.array(range(batch_size, (len(train_losses)+1)*batch_size, batch_size))</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno"><a class="line" href="namespacelstm.html#a7dd406a7c9d4b23190382fa525a26d89">  289</a></span>plt.plot(indep_train_axis, np.array(train_losses),     <span class="stringliteral">&quot;b--&quot;</span>, label=<span class="stringliteral">&quot;Train losses&quot;</span>)</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>plt.plot(indep_train_axis, np.array(train_accuracies), <span class="stringliteral">&quot;g--&quot;</span>, label=<span class="stringliteral">&quot;Train accuracies&quot;</span>)</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span> </div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno"><a class="line" href="namespacelstm.html#af0feb69ac35d94586d9f40ef493daf61">  292</a></span>indep_test_axis = np.append(</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    np.array(range(batch_size, len(test_losses)*display_iter, display_iter)[:-1]),</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    [training_iters]</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>)</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>plt.plot(indep_test_axis, np.array(test_losses),     <span class="stringliteral">&quot;b-&quot;</span>, label=<span class="stringliteral">&quot;Test losses&quot;</span>)</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>plt.plot(indep_test_axis, np.array(test_accuracies), <span class="stringliteral">&quot;g-&quot;</span>, label=<span class="stringliteral">&quot;Test accuracies&quot;</span>)</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>plt.title(<span class="stringliteral">&quot;Training session&#39;s progress over iterations&quot;</span>)</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno"><a class="line" href="namespacelstm.html#a541dda7031d0425c74dd985acdc46eef">  300</a></span>plt.legend(loc=<span class="stringliteral">&#39;upper right&#39;</span>, shadow=<span class="keyword">True</span>)</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>plt.ylabel(<span class="stringliteral">&#39;Training Progress (Loss or Accuracy values)&#39;</span>)</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>plt.xlabel(<span class="stringliteral">&#39;Training iteration&#39;</span>)</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>plt.show()</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno"><a class="line" href="namespacelstm.html#a361bbf59547ec9045a07a2d81d55f1ea">  306</a></span>predictions = one_hot_predictions.argmax(1)</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>print(<span class="stringliteral">&quot;Testing Accuracy: {}%&quot;</span>.format(100*accuracy))</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>print(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>print(<span class="stringliteral">&quot;Precision: {}%&quot;</span>.format(100*metrics.precision_score(y_test, predictions, average=<span class="stringliteral">&quot;weighted&quot;</span>)))</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>print(<span class="stringliteral">&quot;Recall: {}%&quot;</span>.format(100*metrics.recall_score(y_test, predictions, average=<span class="stringliteral">&quot;weighted&quot;</span>)))</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>print(<span class="stringliteral">&quot;f1_score: {}%&quot;</span>.format(100*metrics.f1_score(y_test, predictions, average=<span class="stringliteral">&quot;weighted&quot;</span>)))</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span> </div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>print(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>print(<span class="stringliteral">&quot;Confusion Matrix:&quot;</span>)</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno"><a class="line" href="namespacelstm.html#aeb3029bc8a09205f11491af8c6adf414">  317</a></span>confusion_matrix = metrics.confusion_matrix(y_test, predictions)</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>print(confusion_matrix)</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno"><a class="line" href="namespacelstm.html#aa6f2e7ff69d7a51e121c9e39e6f729be">  319</a></span>normalised_confusion_matrix = np.array(confusion_matrix, dtype=np.float32)/np.sum(confusion_matrix)*100</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>print(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>print(<span class="stringliteral">&quot;Confusion matrix (normalised to % of total test data):&quot;</span>)</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>print(normalised_confusion_matrix)</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>print(<span class="stringliteral">&quot;Note: training and testing data is not equally distributed amongst classes, &quot;</span>)</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>print(<span class="stringliteral">&quot;so it is normal that more than a 6th of the data is correctly classifier in the last category.&quot;</span>)</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span><span class="comment"># Plot Results: </span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>width = 12</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>height = 12</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>plt.figure(figsize=(width, height))</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>plt.imshow(</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    normalised_confusion_matrix, </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno"><a class="line" href="namespacelstm.html#ad2693fddf5db65f346493ea25ab2f29b">  333</a></span>    interpolation=<span class="stringliteral">&#39;nearest&#39;</span>, </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno"><a class="line" href="namespacelstm.html#a43eeb8600acd51ffdea00b6a83774ee4">  334</a></span>    cmap=plt.cm.rainbow</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>)</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>plt.title(<span class="stringliteral">&quot;Confusion matrix \n(normalised to % of total test data)&quot;</span>)</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>plt.colorbar()</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno"><a class="line" href="namespacelstm.html#a9f1acd1b7896bee2bff4697528ed6b74">  338</a></span>tick_marks = np.arange(n_classes)</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno"><a class="line" href="namespacelstm.html#ae94a1e6f52a888a0c7924d404bd743df">  339</a></span>plt.xticks(tick_marks, LABELS, rotation=90)</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>plt.yticks(tick_marks, LABELS)</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>plt.tight_layout()</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>plt.ylabel(<span class="stringliteral">&#39;True label&#39;</span>)</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>plt.xlabel(<span class="stringliteral">&#39;Predicted label&#39;</span>)</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>plt.show()</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>sess.close()</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span><span class="comment"># Outstandingly, **the final accuracy is of 91%**! And it can peak to values such as 93.25%, at some moments of luck during the training, depending on how the neural network&#39;s weights got initialized at the start of the training, randomly. </span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment"># </span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment"># This means that the neural networks is almost always able to correctly identify the movement type! Remember, the phone is attached on the waist and each series to classify has just a 128 sample window of two internal sensors (a.k.a. 2.56 seconds at 50 FPS), so it amazes me how those predictions are extremely accurate given this small window of context and raw data. I&#39;ve validated and re-validated that there is no important bug, and the community used and tried this code a lot. (Note: be sure to report something in the issue tab if you find bugs, otherwise [Quora](https://www.quora.com/), [StackOverflow](https://stackoverflow.com/questions/tagged/tensorflow?sort=votes&amp;pageSize=50), and other [StackExchange](https://stackexchange.com/sites#science) sites are the places for asking questions.)</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="comment"># </span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="comment"># I specially did not expect such good results for guessing between the labels &quot;SITTING&quot; and &quot;STANDING&quot;. Those are seemingly almost the same thing from the point of view of a device placed at waist level according to how the dataset was originally gathered. Thought, it is still possible to see a little cluster on the matrix between those classes, which drifts away just a bit from the identity. This is great.</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="comment"># </span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="comment"># It is also possible to see that there was a slight difficulty in doing the difference between &quot;WALKING&quot;, &quot;WALKING_UPSTAIRS&quot; and &quot;WALKING_DOWNSTAIRS&quot;. Obviously, those activities are quite similar in terms of movements. </span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="comment"># </span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span><span class="comment"># I also tried my code without the gyroscope, using only the 3D accelerometer&#39;s 6 features (and not changing the training hyperparameters), and got an accuracy of 87%. In general, gyroscopes consumes more power than accelerometers, so it is preferable to turn them off. </span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span><span class="comment"># </span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span><span class="comment"># </span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span><span class="comment"># ## Improvements</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span><span class="comment"># </span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span><span class="comment"># In [another open-source repository of mine](https://github.com/guillaume-chevalier/HAR-stacked-residual-bidir-LSTMs), the accuracy is pushed up to nearly 94% using a special deep LSTM architecture which combines the concepts of bidirectional RNNs, residual connections, and stacked cells. This architecture is also tested on another similar activity dataset. It resembles the nice architecture used in &quot;[Googles Neural Machine Translation System: Bridging the Gap between Human and Machine Translation](https://arxiv.org/pdf/1609.08144.pdf)&quot;, without an attention mechanism, and with just the encoder part - as a &quot;many to one&quot; architecture instead of a &quot;many to many&quot; to be adapted to the Human Activity Recognition (HAR) problem. I also worked more on the problem and came up with the [LARNN](https://github.com/guillaume-chevalier/Linear-Attention-Recurrent-Neural-Network), however it&#39;s complicated for just a little gain. Thus the current, original activity recognition project is simply better to use for its outstanding simplicity. </span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="comment"># </span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="comment"># If you want to learn more about deep learning, I have also built a list of the learning ressources for deep learning which have revealed to be the most useful to me [here](https://github.com/guillaume-chevalier/Awesome-Deep-Learning-Resources). </span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="comment"># </span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="comment"># </span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="comment"># ## References</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="comment"># </span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="comment"># The [dataset](https://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones) can be found on the UCI Machine Learning Repository: </span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span><span class="comment"># </span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="comment"># &gt; Davide Anguita, Alessandro Ghio, Luca Oneto, Xavier Parra and Jorge L. Reyes-Ortiz. A Public Domain Dataset for Human Activity Recognition Using Smartphones. 21th European Symposium on Artificial Neural Networks, Computational Intelligence and Machine Learning, ESANN 2013. Bruges, Belgium 24-26 April 2013.</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span><span class="comment"># </span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="comment"># ## Citation</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span><span class="comment"># </span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span><span class="comment"># Copyright (c) 2016 Guillaume Chevalier. To cite my code, you can point to the URL of the GitHub repository, for example: </span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span><span class="comment"># </span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span><span class="comment"># &gt; Guillaume Chevalier, LSTMs for Human Activity Recognition, 2016, </span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span><span class="comment"># &gt; https://github.com/guillaume-chevalier/LSTM-Human-Activity-Recognition</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span><span class="comment"># </span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span><span class="comment"># My code is available for free and even for private usage for anyone under the [MIT License](https://github.com/guillaume-chevalier/LSTM-Human-Activity-Recognition/blob/master/LICENSE), however I ask to cite for using the code. </span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span><span class="comment"># </span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span><span class="comment"># Here is the BibTeX citation code: </span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span><span class="comment"># ```</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span><span class="comment"># @misc{chevalier2016lstms,</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span><span class="comment">#   title={LSTMs for human activity recognition},</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span><span class="comment">#   author={Chevalier, Guillaume},</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span><span class="comment">#   year={2016}</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span><span class="comment"># }</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span><span class="comment"># ```</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span><span class="comment"># </span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span><span class="comment"># ## Extra links</span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span><span class="comment"># </span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span><span class="comment"># ### Connect with me</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span><span class="comment"># </span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span><span class="comment"># - [LinkedIn](https://ca.linkedin.com/in/chevalierg)</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span><span class="comment"># - [Twitter](https://twitter.com/guillaume_che)</span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span><span class="comment"># - [GitHub](https://github.com/guillaume-chevalier/)</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span><span class="comment"># - [Quora](https://www.quora.com/profile/Guillaume-Chevalier-2)</span></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span><span class="comment"># - [YouTube](https://www.youtube.com/c/GuillaumeChevalier)</span></div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span><span class="comment"># - [Dev/Consulting](http://www.neuraxio.com/en/)</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span><span class="comment"># </span></div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span><span class="comment"># ### Liked this project? Did it help you? Leave a [star](https://github.com/guillaume-chevalier/LSTM-Human-Activity-Recognition/stargazers), [fork](https://github.com/guillaume-chevalier/LSTM-Human-Activity-Recognition/network/members) and share the love!</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span><span class="comment"># </span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span><span class="comment"># This activity recognition project has been seen in:</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span><span class="comment"># </span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span><span class="comment"># - [Hacker News 1st page](https://news.ycombinator.com/item?id=13049143)</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span><span class="comment"># - [Awesome TensorFlow](https://github.com/jtoy/awesome-tensorflow#tutorials)</span></div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span><span class="comment"># - [TensorFlow World](https://github.com/astorfi/TensorFlow-World#some-useful-tutorials)</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span><span class="comment"># - And more.</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span><span class="comment"># </span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span><span class="comment"># ---</span></div>
<div class="ttc" id="anamespacelstm_html_a1219948b6046f13ce3223eeb4e4fae9a"><div class="ttname"><a href="namespacelstm.html#a1219948b6046f13ce3223eeb4e4fae9a">lstm.extract_batch_size</a></div><div class="ttdeci">def extract_batch_size(_train, step, batch_size)</div><div class="ttdef"><b>Definition:</b> <a href="lstm_8py_source.html#l00154">lstm.py:154</a></div></div>
<div class="ttc" id="anamespacelstm_html_a2d6b5b10a271e1f89560deba35d1d12d"><div class="ttname"><a href="namespacelstm.html#a2d6b5b10a271e1f89560deba35d1d12d">lstm.one_hot</a></div><div class="ttdeci">def one_hot(y_, n_classes=n_classes)</div><div class="ttdef"><b>Definition:</b> <a href="lstm_8py_source.html#l00169">lstm.py:169</a></div></div>
<div class="ttc" id="anamespacelstm_html_a3bc20b3094c9acd517d4460f1902be84"><div class="ttname"><a href="namespacelstm.html#a3bc20b3094c9acd517d4460f1902be84">lstm.load_X</a></div><div class="ttdeci">def load_X(X_signals_paths)</div><div class="ttdef"><b>Definition:</b> <a href="lstm_8py_source.html#l00041">lstm.py:41</a></div></div>
<div class="ttc" id="anamespacelstm_html_a42deb1962231fef2385848f4fbf685f9"><div class="ttname"><a href="namespacelstm.html#a42deb1962231fef2385848f4fbf685f9">lstm.LSTM_RNN</a></div><div class="ttdeci">def LSTM_RNN(_X, _weights, _biases)</div><div class="ttdef"><b>Definition:</b> <a href="lstm_8py_source.html#l00119">lstm.py:119</a></div></div>
<div class="ttc" id="anamespacelstm_html_ac5423ba2f95f4d9c7810eb3904fac143"><div class="ttname"><a href="namespacelstm.html#ac5423ba2f95f4d9c7810eb3904fac143">lstm.load_y</a></div><div class="ttdeci">def load_y(y_path)</div><div class="ttdef"><b>Definition:</b> <a href="lstm_8py_source.html#l00069">lstm.py:69</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
